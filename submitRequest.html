<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Request Form</title>
    <link rel="stylesheet" href="submitRequest.css">
</head>
<body>

    <header class="main-header">
        <div class="logoSection">
            <img src="assets/images/npc-site-logo.png">
        </div>
        <div class="userDataSection">
            <div class="userImgContainer">
                <img class="userImg" src="assets/images/1697195973305.jpg">
            </div>
            <div class="sittingsMenu">
                <i class="bi bi-gear-wide-connected"></i>
            </div>
            <div class="sittingsMenu">
                <i class="bi bi-translate"></i>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- <div class="lang-switch">
            <button onclick="switchLanguage('en')">English</button>
            <button onclick="switchLanguage('ar')">العربية</button>
        </div> -->
        <h1 id="formTitle">External Data Sharing Request </h1>
        <form id="dataRequestForm">
            <section>
                <h2 id="personalInfoTitle">Requestor Information</h2>
                <div class="form-group" style="margin-left: 10px;">
                    <label for="fullName" id="fullNameLabel">Full Name</label>
                    <input type="text" id="fullName" name="FullName" required>
                </div>

                <div class="form-group width-45-first">
                    <label for="emailAddress" id="emailLabel">Email Address</label>
                    <input type="email" id="emailAddress" name="EmailAddress" required>
                </div>
                <div class="form-group width-45">
                    <label for="phoneNumber" id="phoneLabel">Phone Number</label>
                    <input type="text" id="phoneNumber" name="PhoneNumber" required>
                </div>

                <div class="form-group width-45-first">
                    <label for="jobTitle" id="jobTitleLabel">Job Title</label>
                    <input type="text" id="jobTitle" name="JobTitle" required>
                </div>
                <div class="form-group width-45">
                    <label for="departmentName" id="deptNameLabel">Department Name</label>
                    <input type="text" id="departmentName" name="DepartmentName" required>
                </div>

                <div class="form-group width-45-first">
                    <label for="sectionName" id="sectionLabel">Section Name</label>
                    <input type="text" id="sectionName" name="SectionName" required>
                </div>
                <div class="form-group width-45">
                    <label for="departmentManager" id="deptManagerLabel">Department Manager</label>
                    <input type="text" id="departmentManager" name="DepartmentManager" required>
                </div>
            </section>


            <section>
                <h2 id="requestDetailsTitle">Data Sharing Request Details</h2>

                <div class="form-group width-45-request-first">
                    <label for="entityName" id="entityLabel">Entity Name</label>
                    <select id="entityName" name="EntityName" required>
                        <option value="0">Select...</option>
                    </select>
                </div>
                <div class="form-group width-45-request">
                    <label for="dataOwner" id="dataOwnerLabel">Data Owner Name</label>
                    <select id="dataOwner" name="DataOwner" required>
                        <option value="0">Select...</option>
                    </select>
                </div>
                <div class="form-group" style="margin-left: 11px;">
                    <label for="requestedDataDescription" id="dataDescLabel">Please describe, as precisely as possible, the information you are requesting </label>
                    <textarea id="requestedDataDescription" name="RequestedDataDescription" required></textarea>
                </div>
                <div class="form-group" style="margin-left: 11px;">
                    <label for="reasonForRequest" id="reasonLabel">Clearly state the reason of the request for sharing data</label>
                    <textarea id="reasonForRequest" name="ReasonForRequest" required></textarea>
                </div>
                <div class="form-group">
                    <label for="dataClassification" id="dataClassLabel">State the Classification of the Data: (Public for general data, Confidential if data contains personal data)</label>
                    <select id="dataClassification" name="DataClassification" required style="width: 98.4%;">
                        <option value="1">عام</option>
                        <option value="2">مقيد</option>
                        <option value="3">سري</option>
                        <option value="4">سري للغاية</option>

                        <!-- <option value="1">Public</option>
                        <option value="2">Confidential</option>
                        <option value="3">Secret</option>
                        <option value="4">Top Secret</option> -->
                      </select>
                </div>
                <div class="form-group"  style="width: 98.4%;">
                    <label for="frequency" id="freqLabel">Frequency of Data Sharing</label>
                    <input type="number" id="frequency" name="Frequency" required>
                </div>
                <div class="form-group">
                    <label for="duration" id="durationLabel" style="margin-bottom: 15px;">State the Time Duration of Data Sharing</label>

                    <div>
                        <div class="form-group width-45-first">
                            <label for="startDate" id="startDateLabel">من</label>
                            <input type="date" id="startDate" name="StartDate" required>
                        </div>
    
                        <div class="form-group width-45">
                            <label for="endDate" id="endDateLabel">إلى</label>
                            <input type="date" id="endDate" name="EndDate" required>
                        </div>
                    </div>

                </div>
            </section>

            <button type="button" class="submit-button" onclick="submitForm()">Submit</button>
        </form>
    </div>
    <script>
        function switchLanguage(lang) {
            const translations = {
                en: {
                    formTitle: "External Data Sharing Request",
                    personalInfoTitle: "Requestor Information",
                    fullNameLabel: "Full Name",
                    emailLabel: "Email Address",
                    phoneLabel: "Phone Number",
                    jobTitleLabel: "Job Title",
                    deptNameLabel: "Department Name",
                    sectionLabel: "Section Name",
                    deptManagerLabel: "Department Manager",
                    
                    requestDetailsTitle: "Data Sharing Request Details",
                    entityLabel: "Entity Name",
                    dataOwnerLabel: "Data Owner Name",
                    dataDescLabel: "Please describe, as precisely as possible, the information you are requesting",
                    reasonLabel: "Clearly state the reason of the request for sharing data",
                    dataClassLabel: "State the Classification of the Data: (Public for general data, Confidential if data contains personal data)",
                    freqLabel: "Frequency of Data Sharing",
                    durationLabel: "State the Time Duration of Data Sharing"
                },
                ar: {
                    formTitle: "طلب مشاركة بيانات داخل المجلس",
                    personalInfoTitle: "معلومات مقدم الطلب",
                    fullNameLabel: "الاسم بالكامل",
                    emailLabel: "البريد الإلكترونى",
                    phoneLabel: "\u0631\u0642\u0645 \u0627\u0644\u0647\u0627\u062a\u0641",
                    jobTitleLabel: "\u0627\u0644\u0645\u0633\u0645\u0649 \u0627\u0644\u0648\u0638\u064a\u0641\u064a",
                    deptNameLabel: "اسم الإدارة",
                    sectionLabel: "اسم القسم",
                    deptManagerLabel: "مدير الإدارة",
                    
                    requestDetailsTitle: "تفاصيل طلب مشاركة البيانات",
                    entityLabel: "اسم الجهة",
                    dataOwnerLabel: "اسم مالك البيانات",
                    dataDescLabel: "يرجى وصف المعلومات المطلوبة بوضوح",
                    reasonLabel: "الرجاء ذكر الغرض من طلب مشاركة البيانات",
                    dataClassLabel: "الرجاء ذكر مستوى حساسية البيانات: (عامّة للبيانات العامّة, مقيّدة للبيانات التي تحتوي على بيانات شخصية)",
                    freqLabel: "عدد مرات مشاركة البيانات",
                    durationLabel: "تحديد المدة الزمنية لمشاركة البيانات"
                }
            };

            const elements = translations[lang];
            for (const id in elements) {
                document.getElementById(id).textContent = elements[id];
            }

            const html = document.documentElement;
            html.lang = lang;
            html.dir = lang == 'en'? 'ltr': 'rtl';
        }

        switchLanguage('ar');

        (getEntityNames = async () => {
            const response = await fetch('https://prod-186.westeurope.logic.azure.com:443/workflows/03a77c8fb85b405b970bc4baef40b9db/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=pXZbb3AR1l_l9cibzAU5uPoegChDrB3utrLhd_0ZNyI',
             {        method: 'POST',
                        headers: {
                        'Content-Type': 'application/json'
                    }
            }
        );  
            const entityNames = await response.json();
            const entityNameSelect = document.getElementById('entityName');
            entityNames.forEach(entityName => {
                const option = document.createElement('option');
                option.value = entityName.id;
                option.textContent = entityName.Name;
                entityNameSelect.appendChild(option);
            });
            console.log("entityNames", entityNames);
        })();

        (getDataOwnerNames = async () => {
            const response = await fetch('https://prod-172.westeurope.logic.azure.com:443/workflows/2fe58a00efa348968b2ab7e2a688a7c3/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=OvSIPAazpplKpePllQEZaG419IhBUAmZ2clT-gyxe7g',
             {        method: 'POST',
                        headers: {
                        'Content-Type': 'application/json'
                    }
            }
        );  
            const dataOwnerNames = await response.json();
            const dataOwnerNamesSelect = document.getElementById('dataOwner');
            dataOwnerNames.forEach(entityName => {
                const option = document.createElement('option');
                option.value = entityName.id;
                option.textContent = entityName.Name;
                dataOwnerNamesSelect.appendChild(option);
            });
            console.log("dataOwner", dataOwnerNames);
        })();


    </script>
    <script src="submit.js"></script>
</body>
</html>
